{"ast":null,"code":"var __jsx = React.createElement;\nimport React from 'react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport Sanity from '../../sanity-client.js';\nimport Header from '../../components/Header.js';\nimport Footer from '../../components/Footer.js';\nimport DocumentList from '../../components/DocumentList.js';\nimport { SanityImageUrl, findFocalPoint } from \"../../helperFunctions.js\";\nimport \"../../styles/project.sass\";\nimport { BlockContent, serializers } from \"../../sanity-tools.js\";\n\nclass Project extends React.Component {\n  render() {\n    return __jsx(\"div\", null, __jsx(\"title\", null, this.props.project.title), __jsx(Header, {\n      CurrentPage: \"Project\"\n    }), __jsx(\"div\", {\n      id: \"project-body\"\n    }, __jsx(\"div\", {\n      id: \"hero\"\n    }, __jsx(\"div\", {\n      id: \"ImageContainer\"\n    }, __jsx(\"img\", {\n      src: SanityImageUrl(this.props.project.image, {\n        w: 1500,\n        h: 750\n      })\n    })), __jsx(\"div\", {\n      id: \"ProjectTitle\"\n    }, __jsx(\"h1\", null, this.props.project.title), __jsx(\"div\", {\n      id: \"Stripe\"\n    }))), __jsx(\"div\", {\n      id: \"project-description\"\n    }, __jsx(BlockContent, {\n      blocks: this.props.project.description,\n      serializers: serializers,\n      projectId: \"ocpl5ulk\",\n      dataset: \"pdp-data\"\n    })), __jsx(\"div\", {\n      id: \"Related\"\n    }, __jsx(\"h1\", {\n      id: \"RelatedEventsHeader\"\n    }, this.props.relatedEvents.length > 0 ? 'Related Events:' : ''), __jsx(DocumentList, {\n      data: this.props.relatedEvents,\n      maxLength: 3,\n      image: \"image\",\n      headline: \"title\",\n      primaryDetail: \"readableDate\",\n      secondaryDetail: \"readablePrice\",\n      body: \"Description\"\n    }), __jsx(\"h1\", {\n      id: \"RelatedPostsHeader\"\n    }, this.props.relatedPress.length > 0 ? 'Related Press:' : ''), __jsx(DocumentList, {\n      data: this.props.relatedPress,\n      maxLength: 3,\n      image: \"heroImage\",\n      headline: \"title\",\n      primaryDetail: \"readableDate\",\n      secondaryDetail: null,\n      body: \"body\"\n    }))), __jsx(Footer, null));\n  }\n\n}\n\nProject.getInitialProps = async function (context) {\n  // Get slug from URL\n  var slug = context.query.slug; // Get project data\n\n  var query = `*[_type == \"project\" && slug.current == \"${slug}\"]`;\n  var projects = await Sanity.fetch(query, {});\n  var project = projects[0]; // Get related events\n\n  var currentDate = new Date().toISOString();\n  query = `*[_type == \"event\" && relatedProjects[]._ref == \"${project._id}\" && date >= \"${currentDate}\"]`;\n  var relatedEvents = await Sanity.fetch(query, {});\n\n  for (var event of relatedEvents) {\n    event.readableDate = new Date(event.date).toLocaleString([], {\n      year: 'numeric',\n      month: '2-digit',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n    event.readablePrice = event.price == 0 ? '' : \"$\" + event.price;\n  } // Get related press\n\n\n  query = `*[_type == \"pressclip\" && relatedProjects[]._ref == \"${project._id}\"]`;\n  var relatedPress = await Sanity.fetch(query, {});\n\n  for (var clip of relatedPress) {\n    clip.readableDate = new Date(clip.date).toLocaleString([], {\n      year: 'numeric',\n      month: '2-digit',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  } // Send props\n\n\n  return {\n    project: project,\n    relatedEvents: relatedEvents,\n    relatedPress: relatedPress\n  };\n};\n\nexport default Project;","map":null,"metadata":{},"sourceType":"module"}