{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _getIterator from \"@babel/runtime-corejs2/core-js/get-iterator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Sanity from '../sanity-client.js';\nimport Header from '../components/Header.js';\nimport Footer from '../components/Footer.js';\nimport Document from '../components/Document.js';\nimport autoBind from 'react-autobind';\nimport BottomScrollListener from 'react-bottom-scroll-listener';\nimport Sidebar from \"../components/Sidebar.js\";\nimport Link from 'next/link';\nimport \"../styles/sidebar.sass\";\n\nvar Press =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Press, _React$Component);\n\n  function Press() {\n    var _this;\n\n    _classCallCheck(this, Press);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Press).call(this));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      clips: [],\n      sidebarOpen: false\n    });\n\n    autoBind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Press, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var data = this.props.data;\n      this.setState({\n        clips: data\n      });\n    }\n  }, {\n    key: \"getNextPage\",\n    value: function getNextPage() {\n      var startIndex, endIndex, query, newData, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, clip, oldData;\n\n      return _regeneratorRuntime.async(function getNextPage$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              startIndex = this.state.clips.length;\n              endIndex = startIndex + this.props.pageIncrement;\n              query = \"*[_type == \\\"pressclip\\\"]{ \\\"primaryDetail\\\": author + \\\" for \\\" + organization + \\\" - \\\" + date, ... } | order(date desc) [\".concat(startIndex, \"...\").concat(endIndex, \"]\");\n              _context.next = 5;\n              return _regeneratorRuntime.awrap(Sanity.fetch(query, {}));\n\n            case 5:\n              newData = _context.sent;\n              // Construct secondaryDetail\n              _iteratorNormalCompletion = true;\n              _didIteratorError = false;\n              _iteratorError = undefined;\n              _context.prev = 9;\n\n              for (_iterator = _getIterator(newData); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                clip = _step.value;\n\n                if (typeof clip.articleURL !== \"undefined\") {\n                  clip.secondaryDetail = __jsx(\"a\", {\n                    href: clip.articleURL\n                  }, \"Read it on \" + clip.organization + \" here\");\n                } else {\n                  clip.secondaryDetail = '';\n                }\n              }\n\n              _context.next = 17;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](9);\n              _didIteratorError = true;\n              _iteratorError = _context.t0;\n\n            case 17:\n              _context.prev = 17;\n              _context.prev = 18;\n\n              if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n                _iterator[\"return\"]();\n              }\n\n            case 20:\n              _context.prev = 20;\n\n              if (!_didIteratorError) {\n                _context.next = 23;\n                break;\n              }\n\n              throw _iteratorError;\n\n            case 23:\n              return _context.finish(20);\n\n            case 24:\n              return _context.finish(17);\n\n            case 25:\n              oldData = this.state.clips;\n              this.setState({\n                clips: oldData.concat(newData)\n              });\n\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, [[9, 13, 17, 25], [18,, 20, 24]]);\n    }\n  }, {\n    key: \"onSetSidebarOpen\",\n    value: function onSetSidebarOpen(open) {\n      this.setState({\n        sidebarOpen: open\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var data = this.state.clips;\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = _getIterator(data), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var clip = _step2.value;\n          clip.readableDate = new Date(clip.date).toLocaleString([], {\n            year: 'numeric',\n            month: '2-digit',\n            day: 'numeric'\n          });\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2[\"return\"] != null) {\n            _iterator2[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      var clips = data.map(function (itemData) {\n        return __jsx(Document, {\n          data: itemData,\n          image: \"heroImage\",\n          headline: \"title\",\n          body: \"body\",\n          primaryDetail: \"primaryDetail\",\n          secondaryDetail: \"secondaryDetail\"\n        });\n      });\n      var ArchiveItems = this.props.allClips.map(function (itemData) {\n        return __jsx(Link, {\n          href: \"/pressclip/\" + itemData.slug.current,\n          to: \"/pressclip/\" + itemData.slug.current\n        }, __jsx(\"li\", null, itemData.title));\n      });\n      return __jsx(\"div\", null, __jsx(\"title\", null, \"PDP - Press\"), __jsx(Header, {\n        CurrentPage: \"Press\"\n      }), clips, __jsx(Sidebar, {\n        headline: \"Archive\"\n      }, ArchiveItems), __jsx(BottomScrollListener, {\n        onBottom: this.getNextPage\n      }), __jsx(Footer, null));\n    }\n  }]);\n\n  return Press;\n}(React.Component);\n\nPress.getInitialProps = function _callee(context) {\n  var pageIncrement, query, data, _iteratorNormalCompletion3, _didIteratorError3, _iteratorError3, _iterator3, _step3, clip, allClips;\n\n  return _regeneratorRuntime.async(function _callee$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          // Get pressclips\n          pageIncrement = 2;\n          query = \"*[_type == \\\"pressclip\\\"]{ \\\"primaryDetail\\\": author + \\\" for \\\" + organization + \\\" - \\\" + date, ... } | order(date desc) [0...\".concat(pageIncrement, \"]\");\n          _context2.next = 4;\n          return _regeneratorRuntime.awrap(Sanity.fetch(query, {}));\n\n        case 4:\n          data = _context2.sent;\n          // Construct secondaryDetail\n          _iteratorNormalCompletion3 = true;\n          _didIteratorError3 = false;\n          _iteratorError3 = undefined;\n          _context2.prev = 8;\n\n          for (_iterator3 = _getIterator(data); !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n            clip = _step3.value;\n\n            if (typeof clip.articleURL !== \"undefined\") {\n              clip.secondaryDetail = __jsx(\"a\", {\n                href: clip.articleURL\n              }, \"Read it on \" + clip.organization + \" here\");\n            } else {\n              clip.secondaryDetail = '';\n            }\n          } // Get names of ALL clips\n\n\n          _context2.next = 16;\n          break;\n\n        case 12:\n          _context2.prev = 12;\n          _context2.t0 = _context2[\"catch\"](8);\n          _didIteratorError3 = true;\n          _iteratorError3 = _context2.t0;\n\n        case 16:\n          _context2.prev = 16;\n          _context2.prev = 17;\n\n          if (!_iteratorNormalCompletion3 && _iterator3[\"return\"] != null) {\n            _iterator3[\"return\"]();\n          }\n\n        case 19:\n          _context2.prev = 19;\n\n          if (!_didIteratorError3) {\n            _context2.next = 22;\n            break;\n          }\n\n          throw _iteratorError3;\n\n        case 22:\n          return _context2.finish(19);\n\n        case 23:\n          return _context2.finish(16);\n\n        case 24:\n          query = \"*[_type == \\\"pressclip\\\"]{ title, slug }\";\n          _context2.next = 27;\n          return _regeneratorRuntime.awrap(Sanity.fetch(query, {}));\n\n        case 27:\n          allClips = _context2.sent;\n          return _context2.abrupt(\"return\", {\n            data: data,\n            pageIncrement: pageIncrement,\n            allClips: allClips\n          });\n\n        case 29:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, [[8, 12, 16, 24], [17,, 19, 23]]);\n};\n\nexport default Press;","map":null,"metadata":{},"sourceType":"module"}